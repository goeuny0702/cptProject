<!DOCTYPE html>
<html lang="ko">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Exam Application</title>
    <style>
        body {
            /* width: 100%; */
            font-family: Arial, sans-serif;
            margin: 2vh 2vw 2vh 3vw;
            /* ÏÉÅÎåÄ Îã®ÏúÑ Ï†ÅÏö© */
            background-color: #FFF1FA;
            display: flex;
        }

        /* Î¨∏Ï†ú ÏÑπÏÖò */
        .exam-section {
            flex: 1;
            margin-right: 20vw;
            /* OMR Ìå®ÎÑê ÌÅ¨Í∏∞ÎßåÌÅº Ïó¨Î∞± */
        }

        /* Î¨∏Ï†ú Î∞ïÏä§ */
        .question {
            width: 60vw;
            /* Í∞ÄÎ°ú ÎÑàÎπÑÎ•º % ÎòêÎäî vwÎ°ú Ï°∞Ï†ï */
            margin-bottom: 2vh;
            padding: 2vh;
            background-color: #ffffff;
            border: 0.1vw solid #ddd;
            border-radius: 0.5vw;
        }

        .options label {
            display: block;
            margin-bottom: 0.5vh;
        }

        /* Ï†úÏ∂úÌïòÍ∏∞ Î≤ÑÌäº */
        .submit {
            position: fixed;
            bottom: 5vh;
            right: 2vw;
            width: 18vw;
            /* ÌôîÎ©¥ ÌÅ¨Í∏∞Ïóê Îî∞Îùº Ï°∞Ï†ï */
            height: 6vh;
            border-radius: 0.5vw;
            padding: 1vh;
        }

        .submit-btn {
            width: 100%;
            padding: 1vh;
            background-color: deeppink;
            color: white;
            border: none;
            border-radius: 0.5vw;
            cursor: pointer;
        }

        .submit-btn:hover {
            background-color: pink;
        }

        /* OMR ÎãµÏïàÏßÄ Ïª®ÌÖåÏù¥ÎÑà */
        .omr-section {
            position: fixed;
            top: 2vh;
            right: 2vw;
            width: 18vw;
            /* ÌÅ¨Í∏∞Î•º Í∞ÄÎ≥ÄÏ†ÅÏúºÎ°ú ÏÑ§Ï†ï */
            height: 85vh;
            background-color: #fff;
            border: 0.15vw solid #ddd;
            border-radius: 0.5vw;
            padding: 1.5vh;
            overflow-y: auto;
            box-shadow: 0.2vw 0.2vw 1vw rgba(0, 0, 0, 0.1);
            text-align: center;
        }

        /* OMR Ìó§Îçî */
        .fixed-header {
            margin: 2px 0px 20px 0px;
            position: sticky;
            top: -10px;
            background: white;
            padding: 10px;
            border-bottom: 2px solid #ddd;
            z-index: 10;
        }

        .omr-sheet {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .omr-row {
            display: flex;
            justify-content: center;
            align-items: center;
            margin: 5px 0;
        }

        .omr-question {
            font-weight: bold;
            cursor: pointer;
            margin-right: 10px;
            color: deeppink;
        }

        .omr-question:hover {
            text-decoration: underline;
        }

        .omr-option {
            margin: 0 5px;
            cursor: pointer;
            width: 25px;
            height: 25px;
            border-radius: 50%;
            border: 2px solid deeppink;
            text-align: center;
            line-height: 25px;
            font-weight: bold;
        }

        .selected {
            background-color: deeppink;
            color: white;
        }

        /* Ï†úÏ∂úÌïòÍ∏∞ Î≤ÑÌäº */
        .submit {
            position: fixed;
            bottom: 0px;
            right: 20px;
            width: 300px;
            height: 6vh;
            border-radius: 5px;
            padding: 10px;
        }

        .submit-btn {
            width: 100%;
            padding: 1vh;
            background-color: deeppink;
            color: white;
            border: none;
            border-radius: 0.5vw;
            font-size: 1.2rem;
            cursor: pointer;
        }

        .submit-btn:hover {
            background-color: pink;
        }

        /* üìå Î∞òÏùëÌòï Ï∂îÍ∞Ä */
        @media screen and (max-width: 1024px) {
            .omr-section {
                width: 22vw;
            }

            .omr-option {
                width: 3vw;
                height: 3vw;
                line-height: 3vw;
                font-size: 0.9rem;
            }

            .submit {
                width: 20vw;
            }
        }

        .timer {
            position: fixed;
            top: 17px;
            left: 72%;
            transform: translateX(-50%);
            font-size: 15px;
            font-weight: bold;
            background: white;
            padding: 10px 20px;
            border-radius: 10px;
            border: 1px solid #E3E3E3;
        }
    </style>
</head>

<body>
    <div class="exam-section">
        <h1>2025ÎÖÑÎèÑ Ï†ú 1Ìöå Ï†ïÎ≥¥Ï≤òÎ¶¨Í∏∞ÏÇ¨ Î¨∏Ï†ú</h1>
        <div id="exam-container">Loading...</div>
    </div>
    <div class="omr-section">
        <h2 class="fixed-header" style="text-align: center; font-size: 35px;">Îãµ Ïïà ÏßÄ</h2>
        <div id="omr-container" class="omr-sheet"></div>
    </div>
    <div class="submit">
        <button class="submit-btn" onclick="submitAnswers()">Ï†úÏ∂úÌïòÍ∏∞</button>
    </div>
    <div class="timer" id="timer">
        ÎÇ®ÏùÄ ÏãúÍ∞Ñ : <span id="time-left">60:00</span>
    </div>

    <script>
        let timeLeft = 60 * 60; // 30Î∂Ñ (Ï¥à Îã®ÏúÑ)
        let timerInterval;

        function startTimer() {
            timerInterval = setInterval(() => {
                let minutes = Math.floor(timeLeft / 60);
                let seconds = timeLeft % 60;
                document.getElementById("time-left").textContent =
                    `${minutes}:${seconds < 10 ? '0' + seconds : seconds}`;

                if (timeLeft === 0) {
                    clearInterval(timerInterval);
                    alert("ÏãúÌóò ÏãúÍ∞ÑÏù¥ Ï¢ÖÎ£åÎêòÏóàÏäµÎãàÎã§! ÏûêÎèôÏúºÎ°ú Ï†úÏ∂úÎê©ÎãàÎã§.");
                    submitAnswers();
                }
                timeLeft--;
            }, 1000);
        }

        // Ï†úÌïúÏãúÍ∞Ñ ÏãúÏûë
        startTimer();

        // ÏãúÌóò Ï†úÏ∂ú Ïãú ÌÉÄÏù¥Î®∏ Î©àÏ∂îÍ∏∞
        function submitAnswers() {
            clearInterval(timerInterval);

            const results = questions.map(q => {
                const selected = document.querySelector(`input[name="question-${q.id}"]:checked`);
                return {
                    id: q.id,
                    question: q.question,
                    selectedAnswer: selected ? q.options[parseInt(selected.value)] : "ÏÑ†ÌÉù ÏïàÌï®",
                    correctAnswer: q.options[q.correct - 1],
                    isCorrect: selected ? parseInt(selected.value) === q.correct - 1 : false
                };
            });

            localStorage.setItem("examResults", JSON.stringify(results));
            window.location.href = "result.html";
        }

        let questions = [];

        async function loadQuestions() {
            try {
                const response = await fetch("questions.json");
                questions = await response.json();
                renderQuestions();
                renderOMR();
            } catch (error) {
                console.error("Î¨∏Ï†úÎ•º Î∂àÎü¨Ïò§Îäî Ï§ë Ïò§Î•ò Î∞úÏÉù:", error);
                document.getElementById("exam-container").innerHTML = "Î¨∏Ï†úÎ•º Î∂àÎü¨Ïò§Îäî Îç∞ Ïã§Ìå®ÌñàÏäµÎãàÎã§.";
            }
        }

        function renderQuestions() {
            const examContainer = document.getElementById("exam-container");
            examContainer.innerHTML = "";

            questions.forEach((q, index) => {
                const questionDiv = document.createElement("div");
                questionDiv.className = "question";
                questionDiv.id = `question-${index}`;
                questionDiv.innerHTML = `
                    <p><strong>${index + 1}. ${q.question}</strong></p>
                    <div class="options">
                        ${q.options.map((option, i) => `
                            <label>
                                <input type="radio" name="question-${q.id}" value="${i}" onchange="updateOMR(${index}, ${i})">
                                ${option}
                            </label>
                        `).join("")}
                    </div>
                `;
                examContainer.appendChild(questionDiv);
            });
        }

        function renderOMR() {
            const omrContainer = document.getElementById("omr-container");
            omrContainer.innerHTML = "";

            questions.forEach((q, index) => {
                const omrRow = document.createElement("div");
                omrRow.className = "omr-row";

                omrRow.innerHTML = `
                    <span class="omr-question" onclick="scrollToQuestion(${index})">${index + 1}.</span>
                    ${q.options.map((_, i) => `
                        <div class="omr-option" id="omr-${index}-${i}" onclick="selectOMR(${index}, ${i})">${i + 1}</div>
                    `).join("")}
                `;

                omrContainer.appendChild(omrRow);
            });
        }

        function updateOMR(questionIndex, selectedIndex) {
            for (let i = 0; i < questions[questionIndex].options.length; i++) {
                document.getElementById(`omr-${questionIndex}-${i}`).classList.remove("selected");
            }
            document.getElementById(`omr-${questionIndex}-${selectedIndex}`).classList.add("selected");

            const radios = document.getElementsByName(`question-${questions[questionIndex].id}`);
            radios[selectedIndex].checked = true;
        }

        function selectOMR(questionIndex, selectedIndex) {
            updateOMR(questionIndex, selectedIndex);
        }

        function scrollToQuestion(index) {
            const questionElement = document.getElementById(`question-${index}`);
            if (questionElement) {
                questionElement.scrollIntoView({ behavior: "smooth", block: "center" });
            }
        }

        function submitAnswers() {
            const results = questions.map(q => {
                const selected = document.querySelector(`input[name="question-${q.id}"]:checked`);
                return {
                    id: q.id,
                    question: q.question,
                    selectedAnswer: selected ? q.options[parseInt(selected.value)] : "ÏÑ†ÌÉù ÏïàÌï®",
                    correctAnswer: q.options[q.correct - 1],
                    isCorrect: selected ? parseInt(selected.value) === q.correct - 1 : false
                };
            });

            localStorage.setItem("examResults", JSON.stringify(results));
            window.location.href = "result.html";
        }

        loadQuestions();
    </script>
</body>

</html>